<div>
    <ngx-spinner bdColor="rgba(0,0,0,0.9)" [fullScreen]="true" size="large" color="#fff" type="ball-clip-rotate-pulse">
    </ngx-spinner>
    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                </div>
            </div>
        </div>
    </div>

    <div class="container" style="padding-top: 20px;">
        <div class="row">
            <div class="col-md-2">
                <div class="row">
                    <div class="col-md-12 col-sm-6">
                        <div class="card bg-lite mb-3 filter-top">
                            <h3 class="card-header filter-heading">
                                <span #lbltextENA>Data Status</span>
                            </h3>
                            <ul class="list-group">
                                <ng-container *ngFor="let filter of BiosamplesFilters; let i = index">
                                    <li class="biosample list-group-item d-flex justify-content-between align-items-center biosamples-inactive" [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'biosamples', filter.key)" style="cursor: pointer" *ngIf="filter.key === 'Biosamples - Done'">
                                        <span>Biosamples - Submitted</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>
                                <ng-container *ngFor="let filter of MappedReadsFilters; let i = index">
                                    <li class="list-group-item d-flex justify-content-between align-items-center mapped-reads-inactive" [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'mapped-reads' , filter.key)" style="cursor: pointer" *ngIf="filter.key === 'Mapped reads - Done'">
                                        <span>Mapped Reads - Submitted</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>

                                <ng-container *ngFor="let filter of AssembliesFilters; let i = index">
                                    <li class="list-group-item d-flex justify-content-between align-items-center assemblies-inactive" [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'assemblies' , filter.key)" style="cursor: pointer" *ngIf="filter.key === 'Assemblies - Done'">
                                        <span>Assemblies - Submitted</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>
                                <ng-container *ngFor="let filter of RawDataFilters; let i = index">
                                    <li class="raw-data list-group-item d-flex justify-content-between align-items-center raw-data-inactive" [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'raw-data' , filter.key)" style="cursor: pointer" *ngIf="filter.key === 'Raw data - Done'">
                                        <span>Raw Data - Submitted</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>
                                <ng-container *ngFor="let filter of AnnotationFilters; let i = index">
                                    <li class="list-group-item d-flex justify-content-between align-items-center annotation-inactive" [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'annotation' , filter.key)" style="cursor: pointer" *ngIf="filter.key === 'Annotation - Done'">
                                        <span>Annotation - Submitted</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>
                                <ng-container *ngFor="let filter of AnnotationCompleteFilters; let i = index">
                                    <li class="list-group-item d-flex justify-content-between align-items-center annotation-complete-inactive" [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'annotation-complete' , filter.key)" style="cursor: pointer" *ngIf="filter.key === 'Annotation complete - Done'">
                                        <span>Annotation Complete - Done</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>
                                <ng-container *ngFor="let filter of GenomeFilters; let i = index">
                                    <li class="list-group-item d-flex justify-content-between align-items-center genome-inactive" [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'genome' , filter.key)" style="cursor: pointer" *ngIf="filter.key === 'Genome Notes - Submitted' && filter.doc_count > 0">
                                        <span>Genome Notes - Submitted</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Ontalogy aware filters -->
                <div class="row">
                    <div class="col-md-12 col-sm-6">
                        <div class="card bg-lite mb-3 filter-top">
                            <h3 class="card-header filter-heading">
                                <span>Phylogeny</span>
                            </h3>
                            <ul id="ontology-inactive" class="list-group">
                                <li *ngIf="isFilterSelected" class="rank-heading"> {{selectedFilterValue.rank | uppercase}}
                                </li>
                                <li *ngIf="isFilterSelected" class="list-group-item d-flex justify-content-between align-items-center kingdom active-filter" style="cursor: pointer; padding: .75rem 0.25rem;" id="{{selectedFilterValue.taxonomy}}-kingdom" (click)="showTaxonomyModal($event, currentTaxonomy.rank, currentTaxonomy.taxonomy, 'subkingdom')">
                                    {{selectedFilterValue.taxonomy}} ({{selectedFilterValue.commonName}})
                                    <span class="badge badge-pill badge-info">{{bioSampleTotalCount}}</span>
                                </li>
                                <li *ngIf="!isFilterSelected" class="rank-heading"> KINGDOM </li>
                                <ng-container *ngIf="!isFilterSelected">
                                    <ng-container *ngFor="let super of childTaxanomy.superkingdom">
                                        <li *ngFor="let superchild of super.childData" class="list-group-item d-flex justify-content-between align-items-center kingdom" style="cursor: pointer; padding: .75rem 0.25rem;" id="{{superchild.key}}-kingdom" (click)="showTaxonomyModal($event, super.rank, superchild.key, 'subkingdom')"
                                            (dblclick)="filterTaxonomy(super.rank, superchild.key, 'subkingdom',superchild.commonName.buckets[0].key, superchild.taxId.buckets[0].key)">
                                            {{superchild.key}} ({{superchild.commonName.buckets[0].key}})
                                            <span class="badge badge-pill badge-info">{{superchild.doc_count}}</span>
                                        </li>
                                    </ng-container>
                                </ng-container>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Experiment type filters -->
                <div class="row">
                    <div class="col-md-12 col-sm-6">
                        <div class="card bg-lite mb-3 filter-top">
                            <h3 class="card-header filter-heading">
                                <span>Experiment Type</span>
                            </h3>
                            <ul id="experimentType" class="list-group">
                                <ng-container *ngFor="let filter of experimentTypeFilters; let i = index">
                                    <li class="biosample list-group-item d-flex justify-content-between align-items-center biosamples-inactive" id="{{filter.key}}-Experiment Type"  [ngClass]="checkFilterIsActive(filter.key)" (click)="onFilterClick($event, 'experiment-type', filter.key)" style="cursor: pointer" >
                                        <span>{{filter.key}}</span>
                                        <span class="badge badge-pill badge-info">{{filter.doc_count}}</span>
                                    </li>
                                </ng-container>

                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-10">
                <h1 class="page-header">Organisms</h1>

                <mat-expansion-panel (opened)="expanded()">
                    <mat-expansion-panel-header class="page-header">
                        Column Selection
                    </mat-expansion-panel-header>
                    <div class="col-md-12">
                        <div class="row">
                            <mat-checkbox *ngFor="let data of dataColumnsDefination" class="col-md-4" color="primary" (click)="$event.stopPropagation()" (keydown)="$event.stopPropagation()" [checked]="data.selected" (change)="showSelectedColumn(data, $event.checked)">
                                {{data.name}}
                            </mat-checkbox>
                        </div>
                    </div>
                </mat-expansion-panel>
                <br />

                <button *ngIf="activeFilters.length > 0 || selectedFilterValue != '' && (this.AnnotationFilters.length > 0 || this.AnnotationCompleteFilters.length > 0 || this.AssembliesFilters.length > 0 || this.RawDataFilters.length > 0)" type="button" style="float: right;" class="btn btn-primary" mat-raised-button (click)="openDialog()">Download</button>

                <button type="button" style="float: right;" class="btn btn-primary" mat-raised-button (click)="downloadCSV()">Download metadata</button>
                <h1 *ngIf="activeFilters.length > 0 || selectedFilterValue != ''">Filters:
                    <span *ngIf="(phylSelectedRank != '' && activeFilters.length > 1) || (phylSelectedRank == '' && activeFilters.length > 0)">
                        <span *ngFor="let filter of activeFilters">
                            <span *ngIf="phylSelectedRank != filter">
                                <button type="button" class="btn btn-success">{{filter}}
                                    <span class="badge badge-light" (click)="removeFilter(filter)">X</span>
                    </button>
                    </span>
                    </span>
                    </span>
                    <span *ngIf="selectedFilterValue != ''">
                        <button type="button" class="btn btn-success">{{selectedFilterValue.taxonomy}}
                            <span class="badge badge-light" (click)="removeTaxaFilter(selectedFilterValue.taxonomy)">X</span>
                    </button>
                    </span>
                    <button *ngIf="activeFilters.length > 0 || selectedFilterValue != ''" type="button" class="btn btn-primary" (click)="removeAllFilters()">
                        Remove all filters
                    </button>
                </h1>
                <mat-form-field>
                    <mat-label>Search</mat-label>
                    <input #searchInput matInput [(ngModel)]='searchText' (keyup)="getSearchResults()" placeholder="Ex. lutra" #input>
                </mat-form-field>
                <table mat-table matTableExporter #exporter="matTableExporter" #table [dataSource]="dataSource" matSort (matSortChange)="customSort($event)">
                    <ng-container matColumnDef="organism">
                        <mat-header-cell *matHeaderCellDef mat-sort-header [ngClass]="'w-150 th-left'"> Organism </mat-header-cell>
                        <mat-cell *matCellDef="let element" [ngClass]="'w-150 th-left'">
                            <a [routerLink]="['/data/root/details/', element.id]">
                                {{element.organism}} </a>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="tolid">
                        <mat-header-cell *matHeaderCellDef [ngClass]="'w-80 th-left'"> ToL ID </mat-header-cell>
                        <mat-cell *matCellDef="let element" [ngClass]="'w-80 th-left'"> {{element?.tolid}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="INSDC_ID">
                        <mat-header-cell *matHeaderCellDef [ngClass]="'w-90 th-left'"> INSDC ID </mat-header-cell>
                        <mat-cell *matCellDef="let element" [ngClass]="'w-90 th-left'"> {{element?.INSDC_ID}}</mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="commonName">
                        <mat-header-cell *matHeaderCellDef mat-sort-header [ngClass]="'w-120 th-left'">Common Name </mat-header-cell>
                        <mat-cell *matCellDef="let element" [ngClass]="'w-120 th-left'">
                            {{element?.commonName}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="commonNameSource">
                        <mat-header-cell *matHeaderCellDef mat-sort-header [ngClass]="'w-75 th-center'">Common Name Source</mat-header-cell>
                        <mat-cell *matCellDef="let element" [ngClass]="'w-75 th-center'">
                            <span *ngIf="checkElement(element)" [ngClass]="commonNameSourceStyle(element)" style="width: 65px;text-align: center;">{{element.commonNameSource}}</span>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="currentStatus">
                        <mat-header-cell *matHeaderCellDef mat-sort-header [ngClass]="'w-150 th-left'"> Current status </mat-header-cell>
                        <mat-cell *matCellDef="let element" [ngClass]="'w-150 th-left'">
                            <span [ngClass]="getStatusClass(element.currentStatus)">{{element.currentStatus}}</span>
                        </mat-cell>
                    </ng-container>
                    <ng-container matColumnDef="goatInfo">
                        <mat-header-cell *matHeaderCellDef style=" padding-right: 0px;" [ngClass]="'w-200 th-left'">External references
                        </mat-header-cell>
                        <mat-cell *matCellDef="let element" style=" padding-right: 0px; " [ngClass]="'w-200 th-left'">
                            <span>
                                <a class="no-underline badge badge-pill goat-color" target="_blank"
                                    href="{{element?.goatInfo}}">GoaT info</a>
                                <ng-container *ngIf="checkTolidExists(element)">
                                    <a class="no-underline badge badge-pill goat-color2" target="_blank"
                                        href="{{generateTolidLink(element)}}">ToL QC</a>
                                </ng-container>
                                <ng-container *ngIf="checkGenomeExists(element)">
                                    <a class="no-underline badge badge-pill genome" target="_blank"
                                        href="{{getGenomeURL(element)}}">Genome Note</a>
                                </ng-container>
                            </span>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="biosamples">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Metadata submitted to BioSamples </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                            <span [ngClass]="getStatusClass(element.biosamples)">{{element.biosamples}}</span>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="raw_data">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Raw data submitted to ENA </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                            <span [ngClass]="getStatusClass(element.raw_data)">{{element.raw_data}}</span>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="mapped_reads">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Mapped reads submitted to ENA </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                            <span [ngClass]="getStatusClass(element.mapped_reads)">{{element.mapped_reads}}</span>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="assemblies">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Assemblies submitted to ENA </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                            <span [ngClass]="getStatusClass(element.assemblies_status)">{{element.assemblies_status}}</span>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="annotation_complete">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Annotation complete </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                            <span [ngClass]="getStatusClass(element.annotation_complete)">{{element.annotation_complete}}</span>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="annotation">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Annotation submitted to ENA </mat-header-cell>
                        <mat-cell *matCellDef="let element">
                            <span [ngClass]="getStatusClass(element.annotation_status)">{{element.annotation_status}}</span>
                        </mat-cell>
                    </ng-container>

                    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
                </table>
                <mat-paginator [pageSizeOptions]="[15, 30, 50, 100]" showFirstLastButtons [length]="bioSampleTotalCount" (page)="pageChanged($event)"></mat-paginator>
            </div>
        </div>
    </div>

    <div class="modal fade" id="taxonomyModal" tabindex="-1" role="dialog" aria-labelledby="ontologyModal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title modal-heading" id="ontologyModal" modal-heading>Taxonomy
                    </h1>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="hideTaxaModal()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <ul id="myUL">
                        <!-- subkingdom level -->
                        <ul class="nested subkingdom" *ngIf="childTaxanomy.kingdom.length > 0">
                            <li class="rank-heading">
                                {{currentTaxaOnExpand.childRank | uppercase}}
                            </li>

                            <ng-container *ngFor="let king of childTaxanomy.kingdom">
                                <ng-container>
                                    <li *ngFor="let kingchild of king.childData; let i = index">
                                        <i *ngIf="((king.childData.length == 1 && kingchild.key != 'Other') || (king.childData.length > 1 ))" class="fas fa-plus-circle {{kingchild.key}}-{{king.rank}}" (click)="getChildTaxonomyRankEvent($event, king.rank, kingchild.key, 'superphylum')"></i>
                                        <span *ngIf="((king.childData.length == 1 && kingchild.key != 'Other') || (king.childData.length > 1 ))" class="caret {{kingchild.key}}-{{king.rank}}" id="{{kingchild.key}}-{{king.rank}}" (dblclick)="filterTaxonomy(king.rank, kingchild.key, 'superphylum',kingchild.commonName.buckets[0].key, kingchild.taxId.buckets[0].key)">
                                            {{kingchild.key}} ({{kingchild.commonName.buckets[0].key}})
                                        </span>
                                        <span *ngIf="((king.childData.length == 1 && kingchild.key != 'Other') || (king.childData.length > 1 ))" class="badge badge-pill badge-info {{kingchild.key}}-{{king.rank}}">{{kingchild.doc_count}}</span>
                                        <hr *ngIf="((king.childData.length == 1 && kingchild.key != 'Other') || (king.childData.length > 1 ))" class="{{kingchild.key}}-{{king.rank}}">
                                        <!-- superphylum level -->
                                        <ul class="nested {{kingchild.key}}-superphylum" *ngIf="childTaxanomy.subkingdom.length > 0">
                                            <ng-container *ngFor="let subkingdom of childTaxanomy.subkingdom">
                                                <ng-container *ngIf="kingchild.key === subkingdom.parent">
                                                    <li *ngFor="let subkingchild of subkingdom.childData; let i = index">
                                                        <i *ngIf="((subkingdom.childData.length == 1 && subkingchild.key != 'Other') || (subkingdom.childData.length > 1 ))" class="fas fa-plus-circle {{subkingchild.key}}-{{subkingdom.rank}}" (click)="getChildTaxonomyRankEvent($event, subkingdom.rank, subkingchild.key, 'phylum')"></i>
                                                        <span *ngIf="((subkingdom.childData.length == 1 && subkingchild.key != 'Other') || (subkingdom.childData.length > 1 ))" class="caret {{subkingchild.key}}-{{subkingdom.rank}}" id="{{subkingchild.key}}-{{subkingdom.rank}}" (dblclick)="filterTaxonomy(subkingdom.rank, subkingchild.key, 'phylum',subkingchild.commonName.buckets[0].key, subkingchild.taxId.buckets[0].key)">
                                                            {{subkingchild.key}}
                                                            ({{subkingchild.commonName.buckets[0].key}})
                                                        </span>
                                                        <span *ngIf="((subkingdom.childData.length == 1 && subkingchild.key != 'Other') || (subkingdom.childData.length > 1 ))" class="badge badge-pill badge-info {{subkingchild.key}}-{{subkingdom.rank}}">{{subkingchild.doc_count}}</span>
                                                        <hr *ngIf="((subkingdom.childData.length == 1 && subkingchild.key != 'Other') || (subkingdom.childData.length > 1 ))" class="{{subkingchild.key}}-{{subkingdom.rank}}">
                                                        <!-- phylum level -->
                                                        <ul class="nested {{subkingchild.key}}-phylum" *ngIf="childTaxanomy.superphylum.length > 0">
                                                            <ng-container *ngFor="let superphylum of childTaxanomy.superphylum">
                                                                <ng-container *ngIf="subkingchild.key === superphylum.parent">
                                                                    <li *ngFor="let superphylumchild of superphylum.childData; let i = index">
                                                                        <i *ngIf="((superphylum.childData.length == 1 && superphylumchild.key != 'Other') || (superphylum.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, superphylum.rank, superphylumchild.key, 'subphylum')"></i>
                                                                        <span *ngIf="((superphylum.childData.length == 1 && superphylumchild.key != 'Other') || (superphylum.childData.length > 1 ))" class="caret" id="{{superphylumchild.key}}-{{superphylum.rank}}" (dblclick)="filterTaxonomy(superphylum.rank, superphylumchild.key, 'subphylum',superphylumchild.commonName.buckets[0].key, superphylumchild.taxId.buckets[0].key)">
                                                                            {{superphylumchild.key}}
                                                                            ({{superphylumchild.commonName.buckets[0].key}})
                                                                        </span>
                                                                        <span *ngIf="((superphylum.childData.length == 1 && superphylumchild.key != 'Other') || (superphylum.childData.length > 1 ))" class="badge badge-pill badge-info">{{superphylumchild.doc_count}}</span>
                                                                        <hr *ngIf="((superphylum.childData.length == 1 && superphylumchild.key != 'Other') || (superphylum.childData.length > 1 ))">
                                                                        <!-- subphylum level -->
                                                                        <ul class="nested {{superphylumchild.key}}-subphylum" *ngIf="childTaxanomy.phylum.length > 0">
                                                                            <ng-container *ngFor="let phylum of childTaxanomy.phylum">
                                                                                <ng-container *ngIf="superphylumchild.key === phylum.parent">
                                                                                    <li *ngFor="let phylChild of phylum.childData; let i = index">
                                                                                        <i *ngIf="((phylum.childData.length == 1 && phylChild.key != 'Other') || (phylum.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, phylum.rank, phylChild.key, 'superclass')"></i>
                                                                                        <span *ngIf="((phylum.childData.length == 1 && phylChild.key != 'Other') || (phylum.childData.length > 1 ))" class="caret" id="{{phylChild.key}}-{{phylum.rank}}" (dblclick)="filterTaxonomy(phylum.rank, phylChild.key, 'superclass',phylChild.commonName.buckets[0].key, phylChild.taxId.buckets[0].key)">
                                                                                            {{phylChild.key}}
                                                                                            ({{phylChild.commonName.buckets[0].key}})
                                                                                        </span>
                                                                                        <span *ngIf="((phylum.childData.length == 1 && phylChild.key != 'Other') || (phylum.childData.length > 1 ))" class="badge badge-pill badge-info">{{phylChild.doc_count}}</span>
                                                                                        <hr *ngIf="((phylum.childData.length == 1 && phylChild.key != 'Other') || (phylum.childData.length > 1 ))">
                                                                                        <!-- superclass level -->
                                                                                        <ul class="nested {{phylChild.key}}-superclass" *ngIf="childTaxanomy.subphylum.length > 0">
                                                                                            <ng-container *ngFor="let subphylum of childTaxanomy.subphylum">
                                                                                                <ng-container *ngIf="phylChild.key === subphylum.parent">
                                                                                                    <li *ngFor="let subphylumChild of subphylum.childData; let i = index">
                                                                                                        <i *ngIf="((subphylum.childData.length == 1 && subphylumChild.key != 'Other') || (subphylum.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subphylum.rank, subphylumChild.key, 'class')"></i>
                                                                                                        <span *ngIf="((subphylum.childData.length == 1 && subphylumChild.key != 'Other') || (subphylum.childData.length > 1 ))" class="caret" id="{{subphylumChild.key}}-{{subphylum.rank}}" (dblclick)="filterTaxonomy(subphylum.rank, subphylumChild.key, 'class',subphylumChild.commonName.buckets[0].key, subphylumChild.taxId.buckets[0].key)">
                                                                                                            {{subphylumChild.key}}
                                                                                                            ({{subphylumChild.commonName.buckets[0].key}})
                                                                                                        </span>
                                                                                                        <span *ngIf="((subphylum.childData.length == 1 && subphylumChild.key != 'Other') || (subphylum.childData.length > 1 ))" class="badge badge-pill badge-info">{{subphylumChild.doc_count}}</span>
                                                                                                        <hr *ngIf="((subphylum.childData.length == 1 && subphylumChild.key != 'Other') || (subphylum.childData.length > 1 ))">
                                                                                                        <!-- class level -->
                                                                                                        <ul class="nested {{subphylumChild.key}}-class" *ngIf="childTaxanomy.superclass.length > 0">
                                                                                                            <ng-container *ngFor="let superclass of childTaxanomy.superclass">
                                                                                                                <ng-container *ngIf="subphylumChild.key === superclass.parent">
                                                                                                                    <li *ngFor="let superclassChild of superclass.childData; let i = index">
                                                                                                                        <i *ngIf="((superclass.childData.length == 1 && superclassChild.key != 'Other') || (superclass.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, superclass.rank, superclassChild.key, 'subclass')"></i>
                                                                                                                        <span *ngIf="((superclass.childData.length == 1 && superclassChild.key != 'Other') || (superclass.childData.length > 1 ))" class="caret" id="{{superclassChild.key}}-{{superclass.rank}}" (dblclick)="filterTaxonomy(superclass.rank, superclassChild.key, 'subclass',superclassChild.commonName.buckets[0].key, superclassChild.taxId.buckets[0].key)">
                                                                                                                            {{superclassChild.key}}
                                                                                                                            ({{superclassChild.commonName.buckets[0].key}})
                                                                                                                        </span>
                                                                                                                        <span *ngIf="((superclass.childData.length == 1 && superclassChild.key != 'Other') || (superclass.childData.length > 1 ))" class="badge badge-pill badge-info">{{superclassChild.doc_count}}</span>
                                                                                                                        <hr *ngIf="((superclass.childData.length == 1 && superclassChild.key != 'Other') || (superclass.childData.length > 1 ))">
                                                                                                                        <!-- subclass level -->
                                                                                                                        <ul class="nested {{superclassChild.key}}-subclass" *ngIf="childTaxanomy.class.length > 0">
                                                                                                                            <ng-container *ngFor="let class of childTaxanomy.class">
                                                                                                                                <ng-container *ngIf="superclassChild.key === class.parent">
                                                                                                                                    <li *ngFor="let classChild of class.childData; let i = index">
                                                                                                                                        <i *ngIf="((class.childData.length == 1 && classChild.key != 'Other') || (class.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, class.rank, classChild.key, 'infraclass')"></i>
                                                                                                                                        <span *ngIf="((class.childData.length == 1 && classChild.key != 'Other') || (class.childData.length > 1 ))" class="caret" id="{{classChild.key}}-{{class.rank}}" (dblclick)="filterTaxonomy(class.rank, classChild.key, 'infraclass',classChild.commonName.buckets[0].key, classChild.taxId.buckets[0].key)">
                                                                                                                                            {{classChild.key}}
                                                                                                                                            ({{classChild.commonName.buckets[0].key}})
                                                                                                                                        </span>
                                                                                                                                        <span *ngIf="((class.childData.length == 1 && classChild.key != 'Other') || (class.childData.length > 1 ))" class="badge badge-pill badge-info">{{classChild.doc_count}}</span>
                                                                                                                                        <hr *ngIf="((class.childData.length == 1 && classChild.key != 'Other') || (class.childData.length > 1 ))">
                                                                                                                                        <!-- infraclass level -->
                                                                                                                                        <ul class="nested {{classChild.key}}-infraclass" *ngIf="childTaxanomy.subclass.length > 0">
                                                                                                                                            <ng-container *ngFor="let subclass of childTaxanomy.subclass">
                                                                                                                                                <ng-container *ngIf="classChild.key === subclass.parent">
                                                                                                                                                    <li *ngFor="let subclassChild of subclass.childData; let i = index">
                                                                                                                                                        <i *ngIf="((subclass.childData.length == 1 && subclassChild.key != 'Other') || (subclass.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subclass.rank, subclassChild.key, 'cohort')"></i>
                                                                                                                                                        <span *ngIf="((subclass.childData.length == 1 && subclassChild.key != 'Other') || (subclass.childData.length > 1 ))" class="caret" id="{{subclassChild.key}}-{{subclass.rank}}" (dblclick)="filterTaxonomy(subclass.rank, subclassChild.key, 'cohort',subclassChild.commonName.buckets[0].key, subclassChild.taxId.buckets[0].key)">
                                                                                                                                                            {{subclassChild.key}}
                                                                                                                                                            ({{subclassChild.commonName.buckets[0].key}})
                                                                                                                                                        </span>
                                                                                                                                                        <span *ngIf="((subclass.childData.length == 1 && subclassChild.key != 'Other') || (subclass.childData.length > 1 ))" class="badge badge-pill badge-info">{{subclassChild.doc_count}}</span>
                                                                                                                                                        <hr *ngIf="((subclass.childData.length == 1 && subclassChild.key != 'Other') || (subclass.childData.length > 1 ))">
                                                                                                                                                        <!-- cohort level -->
                                                                                                                                                        <ul class="nested {{subclassChild.key}}-cohort" *ngIf="childTaxanomy.infraclass.length > 0">
                                                                                                                                                            <ng-container *ngFor="let infraclass of childTaxanomy.infraclass">
                                                                                                                                                                <ng-container *ngIf="subclassChild.key === infraclass.parent">
                                                                                                                                                                    <li *ngFor="let infraclassChild of infraclass.childData; let i = index">
                                                                                                                                                                        <i *ngIf="((infraclass.childData.length == 1 && infraclassChild.key != 'Other') || (infraclass.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, infraclass.rank, infraclassChild.key, 'subcohort')"></i>
                                                                                                                                                                        <span *ngIf="((infraclass.childData.length == 1 && infraclassChild.key != 'Other') || (infraclass.childData.length > 1 ))" class="caret" id="{{infraclassChild.key}}-{{infraclass.rank}}" (dblclick)="filterTaxonomy(infraclass.rank, infraclassChild.key, 'subcohort',infraclassChild.commonName.buckets[0].key, infraclassChild.taxId.buckets[0].key)">
                                                                                                                                                                            {{infraclassChild.key}}
                                                                                                                                                                            ({{infraclassChild.commonName.buckets[0].key}})
                                                                                                                                                                        </span>
                                                                                                                                                                        <span *ngIf="((infraclass.childData.length == 1 && infraclassChild.key != 'Other') || (infraclass.childData.length > 1 ))" class="badge badge-pill badge-info">{{infraclassChild.doc_count}}</span>
                                                                                                                                                                        <hr *ngIf="((infraclass.childData.length == 1 && infraclassChild.key != 'Other') || (infraclass.childData.length > 1 ))">
                                                                                                                                                                        <!-- subcohort level -->
                                                                                                                                                                        <ul class="nested {{infraclassChild.key}}-subcohort" *ngIf="childTaxanomy.cohort.length > 0">
                                                                                                                                                                            <ng-container *ngFor="let cohort of childTaxanomy.cohort">
                                                                                                                                                                                <ng-container *ngIf="infraclassChild.key === cohort.parent">
                                                                                                                                                                                    <li *ngFor="let cohortChild of cohort.childData; let i = index">
                                                                                                                                                                                        <i *ngIf="((cohort.childData.length == 1 && cohortChild.key != 'Other') || (cohort.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, cohort.rank, cohortChild.key, 'superorder')"></i>
                                                                                                                                                                                        <span *ngIf="((cohort.childData.length == 1 && cohortChild.key != 'Other') || (cohort.childData.length > 1 ))" class="caret" id="{{cohortChild.key}}-{{cohort.rank}}" (dblclick)="filterTaxonomy(cohort.rank, cohortChild.key, 'superorder',cohortChild.commonName.buckets[0].key, cohortChild.taxId.buckets[0].key)">
                                                                                                                                                                                            {{cohortChild.key}}
                                                                                                                                                                                            ({{cohortChild.commonName.buckets[0].key}})
                                                                                                                                                                                        </span>
                                                                                                                                                                                        <span *ngIf="((cohort.childData.length == 1 && cohortChild.key != 'Other') || (cohort.childData.length > 1 ))" class="badge badge-pill badge-info">{{cohortChild.doc_count}}</span>
                                                                                                                                                                                        <hr *ngIf="((cohort.childData.length == 1 && cohortChild.key != 'Other') || (cohort.childData.length > 1 ))">
                                                                                                                                                                                        <!-- superorder level -->
                                                                                                                                                                                        <ul class="nested {{cohortChild.key}}-superorder" *ngIf="childTaxanomy.subcohort.length > 0">
                                                                                                                                                                                            <ng-container *ngFor="let subcohort of childTaxanomy.subcohort">
                                                                                                                                                                                                <ng-container *ngIf="cohortChild.key === subcohort.parent">
                                                                                                                                                                                                    <li *ngFor="let subcohortChild of subcohort.childData; let i = index">
                                                                                                                                                                                                        <i *ngIf="((subcohort.childData.length == 1 && subcohortChild.key != 'Other') || (subcohort.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subcohort.rank, subcohortChild.key, 'order')"></i>
                                                                                                                                                                                                        <span *ngIf="((subcohort.childData.length == 1 && subcohortChild.key != 'Other') || (subcohort.childData.length > 1 ))" class="caret" id="{{subcohortChild.key}}-{{subcohort.rank}}" (dblclick)="filterTaxonomy(subcohort.rank, subcohortChild.key, 'order',subcohortChild.commonName.buckets[0].key, subcohortChild.taxId.buckets[0].key)">
                                                                                                                                                                                                            {{subcohortChild.key}}
                                                                                                                                                                                                            ({{subcohortChild.commonName.buckets[0].key}})
                                                                                                                                                                                                        </span>
                                                                                                                                                                                                        <span *ngIf="((subcohort.childData.length == 1 && subcohortChild.key != 'Other') || (subcohort.childData.length > 1 ))" class="badge badge-pill badge-info">{{subcohortChild.doc_count}}</span>
                                                                                                                                                                                                        <hr *ngIf="((subcohort.childData.length == 1 && subcohortChild.key != 'Other') || (subcohort.childData.length > 1 ))">
                                                                                                                                                                                                        <!-- order level -->
                                                                                                                                                                                                        <ul class="nested {{subcohortChild.key}}-order" *ngIf="childTaxanomy.superorder.length > 0">
                                                                                                                                                                                                            <ng-container *ngFor="let superorder of childTaxanomy.superorder">
                                                                                                                                                                                                                <ng-container *ngIf="subcohortChild.key === superorder.parent">
                                                                                                                                                                                                                    <li *ngFor="let superorderChild of superorder.childData; let i = index">
                                                                                                                                                                                                                        <i *ngIf="((superorder.childData.length == 1 && superorderChild.key != 'Other') || (superorder.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, superorder.rank, superorderChild.key, 'suborder')"></i>
                                                                                                                                                                                                                        <span *ngIf="((superorder.childData.length == 1 && superorderChild.key != 'Other') || (superorder.childData.length > 1 ))" class="caret" id="{{superorderChild.key}}-{{superorder.rank}}" (dblclick)="filterTaxonomy(superorder.rank, superorderChild.key, 'parvorder', superorderChild.commonName.buckets[0].key, superorderChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                            {{superorderChild.key}}
                                                                                                                                                                                                                            ({{superorderChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                        <span *ngIf="((superorder.childData.length == 1 && superorderChild.key != 'Other') || (superorder.childData.length > 1 ))" class="badge badge-pill badge-info">{{superorderChild.doc_count}}</span>
                                                                                                                                                                                                                        <hr *ngIf="((superorder.childData.length == 1 && superorderChild.key != 'Other') || (superorder.childData.length > 1 ))">
                                                                                                                                                                                                                        <!-- suborder level -->
                                                                                                                                                                                                                        <ul class="nested {{superorderChild.key}}-suborder" *ngIf="childTaxanomy.order.length > 0">
                                                                                                                                                                                                                            <ng-container *ngFor="let order of childTaxanomy.order">
                                                                                                                                                                                                                                <ng-container *ngIf="superorderChild.key === order.parent">
                                                                                                                                                                                                                                    <li *ngFor="let orderChild of order.childData; let i = index">
                                                                                                                                                                                                                                        <i *ngIf="((order.childData.length == 1 && orderChild.key != 'Other') || (order.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, order.rank, orderChild.key, 'infraorder')"></i>
                                                                                                                                                                                                                                        <span *ngIf="((order.childData.length == 1 && orderChild.key != 'Other') || (order.childData.length > 1 ))" class="caret" id="{{orderChild.key}}-{{order.rank}}" (dblclick)="filterTaxonomy(order.rank, orderChild.key, 'infraorder',orderChild.commonName.buckets[0].key, orderChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                            {{orderChild.key}}
                                                                                                                                                                                                                                            ({{orderChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                        <span *ngIf="((order.childData.length == 1 && orderChild.key != 'Other') || (order.childData.length > 1 ))" class="badge badge-pill badge-info">{{orderChild.doc_count}}</span>
                                                                                                                                                                                                                                        <hr *ngIf="((order.childData.length == 1 && orderChild.key != 'Other') || (order.childData.length > 1 ))">
                                                                                                                                                                                                                                        <!-- infraorder level -->
                                                                                                                                                                                                                                        <ul class="nested {{orderChild.key}}-infraorder" *ngIf="childTaxanomy.suborder.length > 0">
                                                                                                                                                                                                                                            <ng-container *ngFor="let parvorder of childTaxanomy.suborder">
                                                                                                                                                                                                                                                <ng-container *ngIf="orderChild.key === parvorder.parent">
                                                                                                                                                                                                                                                    <li *ngFor="let parvorderChild of parvorder.childData; let i = index">
                                                                                                                                                                                                                                                        <i *ngIf="((parvorder.childData.length == 1 && parvorderChild.key != 'Other') || (parvorder.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, parvorder.rank, parvorderChild.key, 'parvorder')"></i>
                                                                                                                                                                                                                                                        <span *ngIf="((parvorder.childData.length == 1 && parvorderChild.key != 'Other') || (parvorder.childData.length > 1 ))" class="caret" id="{{parvorderChild.key}}-{{parvorder.rank}}" (dblclick)="filterTaxonomy(parvorder.rank, parvorderChild.key, 'parvorder',parvorderChild.commonName.buckets[0].key, parvorderChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                            {{parvorderChild.key}}
                                                                                                                                                                                                                                                            ({{parvorderChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                        <span *ngIf="((parvorder.childData.length == 1 && parvorderChild.key != 'Other') || (parvorder.childData.length > 1 ))" class="badge badge-pill badge-info">{{parvorderChild.doc_count}}</span>
                                                                                                                                                                                                                                                        <hr *ngIf="((parvorder.childData.length == 1 && parvorderChild.key != 'Other') || (parvorder.childData.length > 1 ))">
                                                                                                                                                                                                                                                        <!-- parvorder level -->
                                                                                                                                                                                                                                                        <ul class="nested {{parvorderChild.key}}-parvorder" *ngIf="childTaxanomy.infraorder.length > 0">
                                                                                                                                                                                                                                                            <ng-container *ngFor="let suborder of childTaxanomy.infraorder">
                                                                                                                                                                                                                                                                <ng-container *ngIf="parvorderChild.key === suborder.parent">
                                                                                                                                                                                                                                                                    <li *ngFor="let suborderChild of suborder.childData; let i = index">
                                                                                                                                                                                                                                                                        <i *ngIf="((suborder.childData.length == 1 && suborderChild.key != 'Other') || (suborder.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, suborder.rank, suborderChild.key, 'section')"></i>
                                                                                                                                                                                                                                                                        <span *ngIf="((suborder.childData.length == 1 && suborderChild.key != 'Other') || (suborder.childData.length > 1 ))" class="caret" id="{{suborderChild.key}}-{{suborder.rank}}" (dblclick)="filterTaxonomy(suborder.rank, suborderChild.key, 'section',suborderChild.commonName.buckets[0].key, suborderChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                            {{suborderChild.key}}
                                                                                                                                                                                                                                                                            ({{suborderChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                        <span *ngIf="((suborder.childData.length == 1 && suborderChild.key != 'Other') || (suborder.childData.length > 1 ))" class="badge badge-pill badge-info">{{suborderChild.doc_count}}</span>
                                                                                                                                                                                                                                                                        <hr *ngIf="((suborder.childData.length == 1 && suborderChild.key != 'Other') || (suborder.childData.length > 1 ))">
                                                                                                                                                                                                                                                                        <!-- section level -->
                                                                                                                                                                                                                                                                        <ul class="nested {{suborderChild.key}}-section" *ngIf="childTaxanomy.parvorder.length > 0">
                                                                                                                                                                                                                                                                            <ng-container *ngFor="let infraorder of childTaxanomy.parvorder">
                                                                                                                                                                                                                                                                                <ng-container *ngIf="suborderChild.key === infraorder.parent">
                                                                                                                                                                                                                                                                                    <li *ngFor="let infraorderChild of infraorder.childData; let i = index">
                                                                                                                                                                                                                                                                                        <i *ngIf="((infraorder.childData.length == 1 && infraorderChild.key != 'Other') || (infraorder.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, infraorder.rank, infraorderChild.key, 'subsection')"></i>
                                                                                                                                                                                                                                                                                        <span *ngIf="((infraorder.childData.length == 1 && infraorderChild.key != 'Other') || (infraorder.childData.length > 1 ))" class="caret" id="{{infraorderChild.key}}-{{infraorder.rank}}" (dblclick)="filterTaxonomy(infraorder.rank, infraorderChild.key, 'subsection',infraorderChild.commonName.buckets[0].key, infraorderChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                            {{infraorderChild.key}}
                                                                                                                                                                                                                                                                                            ({{infraorderChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                        <span *ngIf="((infraorder.childData.length == 1 && infraorderChild.key != 'Other') || (infraorder.childData.length > 1 ))" class="badge badge-pill badge-info">{{infraorderChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                        <hr *ngIf="((infraorder.childData.length == 1 && infraorderChild.key != 'Other') || (infraorder.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                        <!-- subsection level -->
                                                                                                                                                                                                                                                                                        <ul class="nested {{infraorderChild.key}}-subsection" *ngIf="childTaxanomy.section.length > 0">
                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let section of childTaxanomy.section">
                                                                                                                                                                                                                                                                                                <ng-container *ngIf="infraorderChild.key === section.parent">
                                                                                                                                                                                                                                                                                                    <li *ngFor="let sectionChild of section.childData; let i = index">
                                                                                                                                                                                                                                                                                                        <i *ngIf="((section.childData.length == 1 && sectionChild.key != 'Other') || (section.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, section.rank, sectionChild.key, 'superfamily')"></i>
                                                                                                                                                                                                                                                                                                        <span *ngIf="((section.childData.length == 1 && sectionChild.key != 'Other') || (section.childData.length > 1 ))" class="caret" id="{{sectionChild.key}}-{{section.rank}}" (dblclick)="filterTaxonomy(section.rank, sectionChild.key, 'superfamily',sectionChild.commonName.buckets[0].key, sectionChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                            {{sectionChild.key}}
                                                                                                                                                                                                                                                                                                            ({{sectionChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                        <span *ngIf="((section.childData.length == 1 && sectionChild.key != 'Other') || (section.childData.length > 1 ))" class="badge badge-pill badge-info">{{sectionChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                        <hr *ngIf="((section.childData.length == 1 && sectionChild.key != 'Other') || (section.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                        <!-- superfamily level -->
                                                                                                                                                                                                                                                                                                        <ul class="nested {{sectionChild.key}}-superfamily" *ngIf="childTaxanomy.subsection.length > 0">
                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let subsection of childTaxanomy.subsection">
                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="sectionChild.key === subsection.parent">
                                                                                                                                                                                                                                                                                                                    <li *ngFor="let subsectionChild of subsection.childData; let i = index">
                                                                                                                                                                                                                                                                                                                        <i *ngIf="((subsection.childData.length == 1 && subsectionChild.key != 'Other') || (subsection.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subsection.rank, subsectionChild.key, 'family')"></i>
                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subsection.childData.length == 1 && subsectionChild.key != 'Other') || (subsection.childData.length > 1 ))" class="caret" id="{{subsectionChild.key}}-{{subsection.rank}}" (dblclick)="filterTaxonomy(subsection.rank, subsectionChild.key, 'family',subsectionChild.commonName.buckets[0].key, subsectionChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                            {{subsectionChild.key}}
                                                                                                                                                                                                                                                                                                                            ({{subsectionChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subsection.childData.length == 1 && subsectionChild.key != 'Other') || (subsection.childData.length > 1 ))" class="badge badge-pill badge-info">{{subsectionChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((subsection.childData.length == 1 && subsectionChild.key != 'Other') || (subsection.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                        <!-- family level -->
                                                                                                                                                                                                                                                                                                                        <ul class="nested {{subsectionChild.key}}-family" *ngIf="childTaxanomy.superfamily.length > 0">
                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let superfamily of childTaxanomy.superfamily">
                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="subsectionChild.key === superfamily.parent">
                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let superfamilyChild of superfamily.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((superfamily.childData.length == 1 && superfamilyChild.key != 'Other') || (superfamily.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, superfamily.rank, superfamilyChild.key, 'subfamily')"></i>
                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((superfamily.childData.length == 1 && superfamilyChild.key != 'Other') || (superfamily.childData.length > 1 ))" class="caret" id="{{superfamilyChild.key}}-{{superfamily.rank}}" (dblclick)="filterTaxonomy(superfamily.rank, superfamilyChild.key, 'subfamily',superfamilyChild.commonName.buckets[0].key, superfamilyChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                            {{superfamilyChild.key}}
                                                                                                                                                                                                                                                                                                                                            ({{superfamilyChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((superfamily.childData.length == 1 && superfamilyChild.key != 'Other') || (superfamily.childData.length > 1 ))" class="badge badge-pill badge-info">{{superfamilyChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((superfamily.childData.length == 1 && superfamilyChild.key != 'Other') || (superfamily.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                        <!-- subfamily level -->
                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{superfamilyChild.key}}-subfamily" *ngIf="childTaxanomy.family.length > 0">
                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let family of childTaxanomy.family">
                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="superfamilyChild.key === family.parent">
                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let familyChild of family.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((family.childData.length == 1 && familyChild.key != 'Other') || (family.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, family.rank, familyChild.key, 'tribe')"></i>
                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((family.childData.length == 1 && familyChild.key != 'Other') || (family.childData.length > 1 ))" class="caret" id="{{familyChild.key}}-{{family.rank}}" (dblclick)="filterTaxonomy(family.rank, familyChild.key, 'tribe',familyChild.commonName.buckets[0].key, familyChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                            {{familyChild.key}}
                                                                                                                                                                                                                                                                                                                                                            ({{familyChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((family.childData.length == 1 && familyChild.key != 'Other') || (family.childData.length > 1 ))" class="badge badge-pill badge-info">{{familyChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((family.childData.length == 1 && familyChild.key != 'Other') || (family.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                        <!-- tribe level -->
                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{familyChild.key}}-tribe" *ngIf="childTaxanomy.subfamily.length > 0">
                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let subfamily of childTaxanomy.subfamily">
                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="familyChild.key === subfamily.parent">
                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let subfamilyChild of subfamily.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((subfamily.childData.length == 1 && subfamilyChild.key != 'Other') || (subfamily.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subfamily.rank, subfamilyChild.key, 'subtribe')"></i>
                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subfamily.childData.length == 1 && subfamilyChild.key != 'Other') || (subfamily.childData.length > 1 ))" class="caret" id="{{subfamilyChild.key}}-{{subfamily.rank}}" (dblclick)="filterTaxonomy(subfamily.rank, subfamilyChild.key, 'subtribe',subfamilyChild.commonName.buckets[0].key, subfamilyChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                            {{subfamilyChild.key}}
                                                                                                                                                                                                                                                                                                                                                                            ({{subfamilyChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subfamily.childData.length == 1 && subfamilyChild.key != 'Other') || (subfamily.childData.length > 1 ))" class="badge badge-pill badge-info">{{subfamilyChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((subfamily.childData.length == 1 && subfamilyChild.key != 'Other') || (subfamily.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                        <!-- subtribe level -->
                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{subfamilyChild.key}}-subtribe" *ngIf="childTaxanomy.tribe.length > 0">
                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let tribe of childTaxanomy.tribe">
                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="subfamilyChild.key === tribe.parent">
                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let tribeChild of tribe.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((tribe.childData.length == 1 && tribeChild.key != 'Other') || (tribe.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, tribe.rank, tribeChild.key, 'genus')"></i>
                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((tribe.childData.length == 1 && tribeChild.key != 'Other') || (tribe.childData.length > 1 ))" class="caret" id="{{tribeChild.key}}-{{tribe.rank}}" (dblclick)="filterTaxonomy(tribe.rank, tribeChild.key, 'genus',tribeChild.commonName.buckets[0].key, tribeChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                            {{tribeChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                            ({{tribeChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((tribe.childData.length == 1 && tribeChild.key != 'Other') || (tribe.childData.length > 1 ))" class="badge badge-pill badge-info">{{tribeChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((tribe.childData.length == 1 && tribeChild.key != 'Other') || (tribe.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                        <!-- genus level -->
                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{tribeChild.key}}-genus" *ngIf="childTaxanomy.subtribe.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let subtribe of childTaxanomy.subtribe">
                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="tribeChild.key === subtribe.parent">
                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let subtribeChild of subtribe.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((subtribe.childData.length == 1 && subtribeChild.key != 'Other') || (subtribe.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subtribe.rank, subtribeChild.key, 'series')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subtribe.childData.length == 1 && subtribeChild.key != 'Other') || (subtribe.childData.length > 1 ))" class="caret" id="{{subtribeChild.key}}-{{subtribe.rank}}" (dblclick)="filterTaxonomy(subtribe.rank, subtribeChild.key, 'series',subtribeChild.commonName.buckets[0].key, subtribeChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                            {{subtribeChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                            ({{subtribeChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subtribe.childData.length == 1 && subtribeChild.key != 'Other') || (subtribe.childData.length > 1 ))" class="badge badge-pill badge-info">{{subtribeChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((subtribe.childData.length == 1 && subtribeChild.key != 'Other') || (subtribe.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                        <!-- series level -->
                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{subtribeChild.key}}-series" *ngIf="childTaxanomy.genus.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let genus of childTaxanomy.genus">
                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="subtribeChild.key === genus.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let genusChild of genus.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((genus.childData.length == 1 && genusChild.key != 'Other') || (genus.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, genus.rank, genusChild.key, 'subgenus')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((genus.childData.length == 1 && genusChild.key != 'Other') || (genus.childData.length > 1 ))" class="caret" id="{{genusChild.key}}-{{genus.rank}}" (dblclick)="filterTaxonomy(genus.rank, genusChild.key, 'subgenus',genusChild.commonName.buckets[0].key, genusChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                            {{genusChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                            ({{genusChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((genus.childData.length == 1 && genusChild.key != 'Other') || (genus.childData.length > 1 ))" class="badge badge-pill badge-info">{{genusChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((genus.childData.length == 1 && genusChild.key != 'Other') || (genus.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- subgenus level -->
                                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{genusChild.key}}-subgenus" *ngIf="childTaxanomy.series.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let series of childTaxanomy.series">
                                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="genusChild.key === series.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let seriesChild of series.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((series.childData.length == 1 && seriesChild.key != 'Other') || (series.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, series.rank, seriesChild.key, 'species_group')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((series.childData.length == 1 && seriesChild.key != 'Other') || (series.childData.length > 1 ))" class="caret" id="{{seriesChild.key}}-{{series.rank}}" (dblclick)="filterTaxonomy(series.rank, seriesChild.key, 'species_group',seriesChild.commonName.buckets[0].key, seriesChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                                            {{seriesChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                                            ({{seriesChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((series.childData.length == 1 && seriesChild.key != 'Other') || (series.childData.length > 1 ))" class="badge badge-pill badge-info">{{seriesChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((series.childData.length == 1 && seriesChild.key != 'Other') || (series.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- species_group level -->
                                                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{seriesChild.key}}-species_group" *ngIf="childTaxanomy.subgenus.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let subgenus of childTaxanomy.subgenus">
                                                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="seriesChild.key === subgenus.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let subgenusChild of subgenus.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((subgenus.childData.length == 1 && subgenusChild.key != 'Other') || (subgenus.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subgenus.rank, subgenusChild.key, 'species_subgroup')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subgenus.childData.length == 1 && subgenusChild.key != 'Other') || (subgenus.childData.length > 1 ))" class="caret" id="{{subgenusChild.key}}-{{subgenus.rank}}" (dblclick)="filterTaxonomy(subgenus.rank, subgenusChild.key, 'species_subgroup',subgenusChild.commonName.buckets[0].key, subgenusChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                                                            {{subgenusChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                                                            ({{subgenusChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subgenus.childData.length == 1 && subgenusChild.key != 'Other') || (subgenus.childData.length > 1 ))" class="badge badge-pill badge-info">{{subgenusChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((subgenus.childData.length == 1 && subgenusChild.key != 'Other') || (subgenus.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- species_subgroup level -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{subgenusChild.key}}-species_subgroup" *ngIf="childTaxanomy.species_group.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let speciesgroup of childTaxanomy.species_group">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="subgenusChild.key === speciesgroup.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let speciesgroupChild of speciesgroup.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((speciesgroup.childData.length == 1 && speciesgroupChild.key != 'Other') || (speciesgroup.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, speciesgroup.rank, speciesgroupChild.key, 'species')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((speciesgroup.childData.length == 1 && speciesgroupChild.key != 'Other') || (speciesgroup.childData.length > 1 ))" class="caret" id="{{speciesgroupChild.key}}-{{speciesgroup.rank}}" (dblclick)="filterTaxonomy(speciesgroup.rank, speciesgroupChild.key, 'species',speciesgroupChild.commonName.buckets[0].key, speciesgroupChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            {{speciesgroupChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ({{speciesgroupChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((speciesgroup.childData.length == 1 && speciesgroupChild.key != 'Other') || (speciesgroup.childData.length > 1 ))" class="badge badge-pill badge-info">{{speciesgroupChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((speciesgroup.childData.length == 1 && speciesgroupChild.key != 'Other') || (speciesgroup.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- species level -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{speciesgroupChild.key}}-species" *ngIf="childTaxanomy.species_subgroup.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let speciessubgroup of childTaxanomy.species_subgroup">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="speciesgroupChild.key === speciessubgroup.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let speciessubgroupChild of speciessubgroup.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((speciessubgroup.childData.length == 1 && speciessubgroupChild.key != 'Other') || (speciessubgroup.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, speciessubgroup.rank, speciessubgroupChild.key, 'subspecies')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((speciessubgroup.childData.length == 1 && speciessubgroupChild.key != 'Other') || (speciessubgroup.childData.length > 1 ))" class="caret" id="{{speciessubgroupChild.key}}-{{speciessubgroup.rank}}" (dblclick)="filterTaxonomy(speciessubgroup.rank, speciessubgroupChild.key, 'subspecies',speciessubgroupChild.commonName.buckets[0].key, speciessubgroupChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            {{speciessubgroupChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ({{speciessubgroupChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((speciessubgroup.childData.length == 1 && speciessubgroupChild.key != 'Other') || (speciessubgroup.childData.length > 1 ))" class="badge badge-pill badge-info">{{speciessubgroupChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((speciessubgroup.childData.length == 1 && speciessubgroupChild.key != 'Other') || (speciessubgroup.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- subspecies level -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{speciessubgroupChild.key}}-subspecies" *ngIf="childTaxanomy.species.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let species of childTaxanomy.species">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="speciessubgroupChild.key === species.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let speciesChild of species.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((species.childData.length == 1 && speciesChild.key != 'Other') || (species.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, species.rank, speciesChild.key, 'varietas')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((species.childData.length == 1 && speciesChild.key != 'Other') || (species.childData.length > 1 ))" class="caret" id="{{speciesChild.key}}-{{species.rank}}" (dblclick)="filterTaxonomy(species.rank, speciesChild.key, 'varietas',speciesChild.commonName.buckets[0].key, speciesChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            {{speciesChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ({{speciesChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((species.childData.length == 1 && speciesChild.key != 'Other') || (species.childData.length > 1 ))" class="badge badge-pill badge-info">{{speciesChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((species.childData.length == 1 && speciesChild.key != 'Other') || (species.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- varietas level -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{speciesChild.key}}-varietas" *ngIf="childTaxanomy.subspecies.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let subspecies of childTaxanomy.subspecies">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="speciesChild.key === subspecies.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let subspeciesChild of subspecies.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <i *ngIf="((subspecies.childData.length == 1 && subspeciesChild.key != 'Other') || (subspecies.childData.length > 1 ))" class="fas fa-plus-circle" (click)="getChildTaxonomyRankEvent($event, subspecies.rank, subspeciesChild.key, 'forma')"></i>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subspecies.childData.length == 1 && subspeciesChild.key != 'Other') || (subspecies.childData.length > 1 ))" class="caret" id="{{subspeciesChild.key}}-{{subspecies.rank}}" (dblclick)="filterTaxonomy(subspecies.rank, subspeciesChild.key, 'forma', subspeciesChild.commonName.buckets[0].key, subspeciesChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            {{subspeciesChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ({{subspeciesChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((subspecies.childData.length == 1 && subspeciesChild.key != 'Other') || (subspecies.childData.length > 1 ))" class="badge badge-pill badge-info">{{subspeciesChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((subspecies.childData.length == 1 && subspeciesChild.key != 'Other') || (subspecies.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- forma level -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <ul class="nested {{subspeciesChild.key}}-forma" *ngIf="childTaxanomy.varietas.length > 0">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <ng-container *ngFor="let varietas of childTaxanomy.varietas">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <ng-container *ngIf="subspeciesChild.key === varietas.parent">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <li *ngFor="let varietasChild of varietas.childData; let i = index">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <!-- <i *ngIf="((varietas.childData.length == 1 && varietasChild.key != 'Other') || (varietas.childData.length > 1 ))"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            class="fas fa-plus-circle"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (click)="getChildTaxonomyRankEvent($event, varietas.rank, varietasChild.key, '')"></i> -->
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((varietas.childData.length == 1 && varietasChild.key != 'Other') || (varietas.childData.length > 1 ))" class="caret" id="{{varietasChild.key}}-{{varietas.rank}}" (dblclick)="filterTaxonomy(varietas.rank, varietasChild.key, 'forma',varietasChild.commonName.buckets[0].key, varietasChild.taxId.buckets[0].key)">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            {{varietasChild.key}}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ({{varietasChild.commonName.buckets[0].key}})
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span *ngIf="((varietas.childData.length == 1 && varietasChild.key != 'Other') || (varietas.childData.length > 1 ))" class="badge badge-pill badge-info">{{varietasChild.doc_count}}</span>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <hr *ngIf="((varietas.childData.length == 1 && varietasChild.key != 'Other') || (varietas.childData.length > 1 ))">
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                                    </li>
                                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                                        </ul>
                                                                                                                                                                                                    </li>
                                                                                                                                                                                                </ng-container>
                                                                                                                                                                                            </ng-container>
                                                                                                                                                                                        </ul>
                                                                                                                                                                                    </li>
                                                                                                                                                                                </ng-container>
                                                                                                                                                                            </ng-container>
                                                                                                                                                                        </ul>
                                                                                                                                                                    </li>
                                                                                                                                                                </ng-container>
                                                                                                                                                            </ng-container>
                                                                                                                                                        </ul>
                                                                                                                                                    </li>
                                                                                                                                                </ng-container>
                                                                                                                                            </ng-container>
                                                                                                                                        </ul>
                                                                                                                                    </li>
                                                                                                                                </ng-container>
                                                                                                                            </ng-container>
                                                                                                                        </ul>
                                                                                                                    </li>
                                                                                                                </ng-container>
                                                                                                            </ng-container>
                                                                                                        </ul>
                                                                                                    </li>
                                                                                                </ng-container>
                                                                                            </ng-container>
                                                                                        </ul>
                                                                                    </li>
                                                                                </ng-container>
                                                                            </ng-container>
                                                                        </ul>
                                                                    </li>
                                                                </ng-container>
                                                            </ng-container>
                                                        </ul>
                                                    </li>
                                                </ng-container>
                                            </ng-container>
                                        </ul>
                                    </li>
                                </ng-container>
                            </ng-container>
                        </ul>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
